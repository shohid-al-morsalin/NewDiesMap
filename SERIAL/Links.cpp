/* Generated by Together */

#include "stdafx.h"
#include "Links.h"
#include "MsgItem.h"

// Check OutQue for something to send
CMsgItem* CLinks::Check() {
	CSingleLock Lock(&CS);
	Lock.Lock();
	return OutQue.RemoveHead();
}

// Deposit CMsgItem into OutQue
CRtnCode::RCODE CLinks::Put(CMsgItem* pMsg) {
	CSingleLock Lock(&CS);
	Lock.Lock();
	if (pMsg) {
		return OutQue.AddTail(pMsg);
	}
	return CRtnCode::ERR;
}

CRtnCode::RCODE CLinks::Put(char* pMsg) {
	CMsgItem* p = new CMsgItem;
	if (p) {
		int len = strlen(pMsg);
		if (p->SetAlloc(pMsg, len)) {
			//TRACE("Add-");
			//TRACE(p->pMsg);
			//TRACE("\n");
			return Put(p);
		}
		// fail to set so delete
		delete p;
	}
	return CRtnCode::ERR;
}

CMsgItem* CLinks::Get() {
	CSingleLock Lock(&CS);
	Lock.Lock();
	return InQue.RemoveHead();
}

CLinks::CLinks() {}

CLinks::~CLinks() {}

void CLinks::Clear() {
	InQue.Clear();
	OutQue.Clear();
	RpyQue.Clear();
}